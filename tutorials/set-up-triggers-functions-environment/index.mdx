---
meta:
  title: Setting up your demo environment to use Serverless Functions and Triggers
  description: This pages shows you how to set up your environment to create a demo using Serverless Functions and Triggers
content:
  h1: Setting up your demo environment to use Serverless Functions and Triggers
  paragraph: This pages shows you how to set up your environment to create a demo using Serverless Functions and Triggers
categories:
  - serverless
tags: serverless serverless-functions functions serverless-triggers triggers sqs-queue
dates:
  validation: 2023-06-19
  posted: 2023-06-19
---

Introduction

Serverless Functions works best in event-driven projects. Event-driven means that all functions are triggers by events generally stored in queues, it is an asynchronous microservice architecture where event producers are decorelated from event consumers, which means that they can be edited if needed without requiring to edit all microservices.
Requirements

    A Scaleway Account
    Node JS 20 (optional but recommended if you want to package the zip yourself)
    Around 10 JPG or PNG images
    curl

Project Setup

Let's start the tutorial by creating a Projects and some resources that will be used by the Functions.

    A project to gather every resources and keep everything isolated from existing Scaleway infrastructure
    Buckets to store media
    A Queue to support the Eventing part of the tutorial
    IAM credentials to secure everything
    A Cockpit to monitor functions execution

Create a New Project

    In Scaleway Console, create a New Project
    Name it Tutorial Function

Now we are going to create some resources
Create Buckets

To store our files

    Go to Storage>Object Storage
    Create a bucket named: myimagesource-{YourName} (For example, myimagesource-eddy)
        in the Amsterdam Region
        Define it as Private
        Drop some images in the bucket (approx 10) (you can use the default storage class)
    Create a bucket named: myimagedest-{YourName} (For example, myimagedest-eddy) 
        in the Amsterdam Region
        Define it as Private

A Message Queue

To enable a reliable communication between our functions

    Go to Serverless > Messaging
    Click Create a namespace
        Choose SQS/SNS as type
        Copy the Namespace URL shown in the console (we will use it later using the parameter SQS_ENDPOINT, be careful to copy it somewhere safe with no space)
    Generate credentials
        Click Generate credentials
        Name it Function Push
        Add the Write/Read/Manage permissions (select all options)
        Click Generate
        Save the Access Key ID and the Secret Key somewhere safe (we will use them later using the parameters SQS_ACCESS_KEY_ID and SQS_ACCESS_KEY, be careful to copy it somewhere safe with no space)
    Create a Queue
        Go to the Queues tab
        Click Create a queue
        Select Standard
        Name it image-queue 
        Keep the default values in every other fields.
        Click Create a queue
        Copy the Queue URL (we will use them later using the parameter QUEUE_URL, be careful to copy it somewhere safe with no space)

IAM credentials

IAM credentials enable to secure access to our buckets, functions... For this tutorial we will use User credentials which are simpler to use, however for production grade Serverless applications it is recommended to define Applications with the minimum possible rights

    Click Organisation (top=left) and Select IAM
    Go to the API keys tab
    Click Generate an API key ( (plus) button)
        Select Myself as Key Bearer
        Add the following description “API for the Function Tutorial”
        Set Expiration at One Week
        Will this API key be used for Object Storage?
            Select Yes, set up preferred Project
            Choose the Tutorial Function project
        Generate the API key and save it somewhere safe (we will use them later using the parameters S3_ACCESS_KEY and S3_ACCESS_KEY)

Cockpit

    Go to Observability>Cockpit
    Click Activate Cockpit
    Go to the Grafana users tab and click Add user
    Copy the password somewhere safe

Conclusion

You now have created all resources needed for the functions to work, Scaleway projects, especially serverless ones will often require you to create these resources. It is fastidious to create all these resources manually, an efficient way to do it would be to use IAC tools such as Terraform.

Now let's create some functions.